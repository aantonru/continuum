{"ast":null,"code":"//import axios from \"axios\";\nimport { store } from '../../index';\nexport function photosHasError(bool) {\n  return {\n    type: 'PHOTOS_HAS_ERRORED',\n    hasError: bool\n  };\n}\nexport function photosIsLoading(bool) {\n  return {\n    type: 'PHOTOS_IS_LOADING',\n    isLoading: bool\n  };\n}\nexport function photosFetchDataSuccess(photos) {\n  return {\n    type: 'PHOTOS_FETCH_DATA_SUCCESS',\n    photos: photos\n  };\n}\nexport const photosClear = {\n  type: 'PHOTOS_CLEAR'\n};\nexport function photosFound(count) {\n  return {\n    type: 'PHOTOS_FOUND',\n    photosFound: count\n  };\n}\nexport function gotPredictions(id, predictions) {\n  return {\n    type: 'GOT_PRED',\n    id,\n    predictions\n  };\n}\nexport function getNsfw(id, url, width, height) {\n  return async dispatch => {\n    const img = new Image();\n    img.width = width;\n    img.height = height;\n    img.crossOrigin = 'anonymous';\n    img.src = url;\n    console.log(img);\n    let state = store.getState();\n    const predictions = await state.model.classify(img);\n    console.log(predictions);\n    dispatch(gotPredictions(id, predictions));\n  };\n}\nexport function photosSearch(params) {\n  console.log('--search params--');\n  console.log(params);\n  return dispatch => {\n    dispatch(photosIsLoading(true));\n    const VK = window.VK;\n\n    if (VK && VK !== null && VK !== 'undefined') {\n      VK.Api.call('photos.search', {\n        lat: params.lat,\n        long: params.long,\n        sort: params.sort,\n        offset: params.offset,\n        count: params.count,\n        radius: params.radius,\n        start_time: params.start_time,\n        end_time: params.end_time,\n        v: params.v\n      }, r => {\n        // eslint-disable-line no-undef\n        dispatch(photosIsLoading(false));\n\n        if (r.response && r.response !== 'undefined' && r.response.items && r.response.items !== 'undefined') {\n          dispatch(photosFound(r.response.count));\n          dispatch(photosFetchDataSuccess(r.response.items)); //                    r.response.items.map((item) => {\n          //                        let size=Math.floor(item.sizes.length/2)+1;\n          //                        dispatch(getNsfw(item.id, item.sizes[size].url, item.sizes[size].width, item.sizes[size].height));\n          //                    })\n        } else {\n          dispatch(photosHasError());\n        }\n\n        console.log('--response--');\n        console.log(r);\n      });\n    } else {\n      dispatch(photosIsLoading(false));\n      dispatch(photosHasError());\n    }\n  };\n}","map":{"version":3,"sources":["/Users/Shared/www/continuum/continuum/src/components/actions/photos.js"],"names":["store","photosHasError","bool","type","hasError","photosIsLoading","isLoading","photosFetchDataSuccess","photos","photosClear","photosFound","count","gotPredictions","id","predictions","getNsfw","url","width","height","dispatch","img","Image","crossOrigin","src","console","log","state","getState","model","classify","photosSearch","params","VK","window","Api","call","lat","long","sort","offset","radius","start_time","end_time","v","r","response","items"],"mappings":"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","sourcesContent":["//import axios from \"axios\";\nimport { store } from '../../index';\n\nexport function photosHasError(bool) {\n    return {\n        type: 'PHOTOS_HAS_ERRORED',\n        hasError: bool\n    };\n}\n\nexport function photosIsLoading(bool) {\n    return {\n        type: 'PHOTOS_IS_LOADING',\n        isLoading: bool\n    };\n}\n\nexport function photosFetchDataSuccess(photos) {\n    return {\n        type: 'PHOTOS_FETCH_DATA_SUCCESS',\n        photos: photos,\n    };\n}\n\nexport const photosClear = {\n    type: 'PHOTOS_CLEAR'\n}\n\nexport function photosFound(count) {\n    return {\n        type: 'PHOTOS_FOUND',\n        photosFound: count\n    };\n}\n\nexport function gotPredictions(id, predictions) {\n    return {\n        type: 'GOT_PRED',\n        id,\n        predictions\n    }\n}\n\nexport function getNsfw(id, url, width, height) {\n    return async (dispatch) => {\n    const img = new Image();\n    img.width=width;\n    img.height=height;\n    img.crossOrigin = 'anonymous';\n    img.src = url;\n    console.log(img);\n    let state=store.getState();\n    const predictions = await state.model.classify(img);    \n    console.log(predictions);\n    dispatch(gotPredictions(id,predictions));\n    }\n}\n\nexport function photosSearch(params) {\n    console.log('--search params--');\n    console.log(params);\n \n    return (dispatch) => {\n        dispatch(photosIsLoading(true));\n        const VK = window.VK;\n        if (VK && VK!==null && VK!=='undefined') {\n            VK.Api.call('photos.search', {lat:params.lat, long:params.long, sort:params.sort, offset:params.offset, count:params.count, radius:params.radius, start_time:params.start_time, end_time:params.end_time, v:params.v},(r) => { // eslint-disable-line no-undef\n                dispatch(photosIsLoading(false));\n                if (r.response && r.response!=='undefined' && r.response.items && r.response.items!=='undefined') {\n                    dispatch(photosFound(r.response.count));\n                    dispatch(photosFetchDataSuccess(r.response.items));\n//                    r.response.items.map((item) => {\n//                        let size=Math.floor(item.sizes.length/2)+1;\n//                        dispatch(getNsfw(item.id, item.sizes[size].url, item.sizes[size].width, item.sizes[size].height));\n//                    })\n                } else {\n                    dispatch(photosHasError())\n                }\n                console.log('--response--');\n                console.log(r);\n            });\n        } else {\n            dispatch(photosIsLoading(false));\n            dispatch(photosHasError())\n        }\n    }\n}"]},"metadata":{},"sourceType":"module"}